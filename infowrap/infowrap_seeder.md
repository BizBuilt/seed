# Infowrap seeder

The Infowrap Seeder takes seed files in JSON format as input and generates content based on those files in our database.

Each seed file should contain one [seed](#seed) at it's root level.


## Usage

The Infowrap Seeder is built into the [api.infowrap.com](https://github.com/BizBuilt/api.infowrap.com) repository. You must download the repository and follow it's setup instructions before using the seeder.

The following commands must be run from within the *api.infowrap.com* project folder on your system.


### Note

Since some data created by seeds can conflict with existing data, it is a good idea to clear out your database before running a seed. If you are running multiple seeds that will not conflict, you may simply run each seed in order without resetting the database.

Reset database:

	rake db:drop; rake db:create; rake db:migrate


### Command

	bundle exec rake infowrap:seed[path,generate_graph]

- `path` - a quoted string for the path to the seed file
- `generate_graph` - (optional) set to true if you want a wrap network graph image to be generated from the information generated by the seed

To generate graphs, you must install [graphviz](http://www.graphviz.org/).


### Examples

Run the seed located at "/Users/user/projects/seed/infowrap/test/seed.json":

	bundle exec rake infowrap:seed['/Users/user/projects/seed/infowrap/test/seed.json']

Generate a wrap graph based on the data seeded:

	bundle exec rake infowrap:seed['/Users/user/projects/seed/infowrap/test/seed.json',true]


## Standards and helpers

The following are certain standards that are common to different types of data in a seed. There are also a variety of helper directives that may be used when constructing a seed.


### Visibility

Any asset objects with "visibility" properties support the following values:

- `"private"` - visible only to the asset's owner
- `"all"` - all wraps connected to the asset's owner can see this asset
- `"public"` - visible to everyone
- `"some"` - visible only to some of the wraps connected to this asset's owner
- [wrap identifiers](#wrap-identifiers) - sets visibility to some and ensures the proper connections are made for the wraps involved


### Helpers

These are values that may be used in the JSON structure to generate different types of content.

- `"$lorem_ipsum"` - generates a block of filler text
- `"$random_hex"` - generates a random alphanumeric string
- `"$random_number"` - replaces the string value with a random integer when processed


### Wrap identifiers

When referencing a single [wrap](#wrap) or a list of [wraps](#wrap), use a single string or an array of wrap identifiers and group names. To specify a [wrap group](#wrap-group), add a leading "$" to the group's name in the wrap identifier value or array to distinguish it from a wrap identifier (the [wrap group](#wrap-group) itself should not be named with a "$").

The following example shows a wrap where the connections and connection requests properties reference the "ourteam" and "random-wraps" groups in addition to the johnsmith wrap:

    {
	  "name": "Mary Sue",
	  "identifier": "marysue",
	  "public": false,
	  "featured": false,
	  "connections": ["johnsmith", "$ourteam"],
	  "connection_requests": ["$random-wraps"]
    }

If a wrap group name is used when a single wrap is expected, as with specifying the reader of a [discussion](#discussion), the first wrap in that group will be selected.


### Tags

All assets support tagging. To apply tags to an individual asset, specify them in an array called "tags" on the asset's seed data.

Each tag should be a string containing a valid tag value. Nested tags may be created by specifying the full, "/" delimited path for the tag.

Example:

    {
	  "name": "test-1.txt",
	  "file": "files/lorem_ipsum.txt",
	  "tags": ["abc/def", "xyz"]
    }


## Seed

The root level object in a seed JSON file may specify the name of the seed, the individual accounts to generate, and the groups to generate and process.

- `name` - name of the seed (used only for documentation purposes and the name of the graph generated by the seeder)
- `groups` - array of [wrap groups](#wrap-group) which provide a means of generating random content as well as quickly building certain types of relationships among content (connections and connection requests for one)
- `accounts` - array of [accounts](#account) specifying individual accounts to create


## Wrap group

Groups make it easy to generate a random assortment of content as well as setting up complex relationships among groups and individual items generated by the seeder.

- `name` - name of the group that may be used as a string identifier to reference the group
- `wraps` - specifies which wraps belong to this group
  - *(Accepted Values)*
    - [wrap identifiers](#wrap-identifiers) (should be wraps specified under the seed's accounts collection since they're static)
	- object with options for generating a random set of wraps and related content
	  - `count` - number of accounts to create
	  - `wrap_count` - number of wraps to create for each account (default 1)
	  - `public` - true causes all of the generated wraps for this group to be public
	  - `featured` - true causes all of the generated wraps for this group to be featured
	  - `wrap_template` - [wrap](#wrap) object to use as a template for building all wraps in this group (name, identifier, public, and featured are set by the group, so any values in the template will be overridden)
- `connections` - [wrap identifiers](#wrap-identifiers) for wraps this group should connect to
- `interconnected` - true causes this group's wraps to form connections amongst themselves (every wrap connected to every other wrap)
- `connection_requests` - [wrap identifiers](#wrap-identifiers) for wraps this group should request connections to
- `interconnected_requests` - true causes this group's wraps to make connection requests amongst themselves (every wrap makes a request to every other wrap)


## Account

- `name` - full name for the account
- `login` - login username
- `password` - login password
- `email` - email to send this account's notifications to
- `wraps` - array of [wrap](#wrap) objects to place under this account


## Wrap

- `name` - name of the wrap
- `identifier` - unique identifier for the wrap (value can be used as a reference in the seed structure for specifying this wrap in different contexts)
- `public` - setting to true causes this wrap to be listed publicly
- `featured` - setting to true causes this wrap to be included in the featured wraps list
- `avatar`
  - `name` - file name for the avatar file asset
  - `file` - path relative to the seed file where the file is located locally
- `cover`
  - `name` - file name for the cover file asset
  - `file` - path relative to the seed file where the file is located locally
- `connections` - [wrap identifiers](#wrap-identifiers) specifying which wraps this one should be connected to (does not need to be on both wraps being connected, only one is needed to form a mutual connection)
- `connection_requests` - [wrap identifiers](#wrap-identifiers) specifying which wraps this one should send connection requests to
- `about` - array of [about](#about) objects
- `contacts` - array of [contact](#contact) objects
- `locations` - array of [location](#location) objects
- `discussions` - array of [discussion](#discussion) objects
- `files` - array of [file](#file) objects
- `galleries` - array of [gallery](#gallery) objects


## About

- `visibility` - see [Visibility](#visibility)
- `tags` - see [Tags](#tags)
- `name` - title
- `content` - text content


## Contact

- `visibility` - see [Visibility](#visibility)
- `name` - name of the contact
- `data` - array of contact assets
  - `tags` - see [Tags](#tags)
  - `name` - type of contact information
  - `value`


## Location

- `visibility` - see [Visibility](#visibility)
- `name` - name of the location
- `data` - array of contact assets
  - `tags` - see [Tags](#tags)
  - `name` - type of contact information
  - `value`


## Discussion

- `visibility` - see [Visibility](#visibility)
- `tags` - see [Tags](#tags)
- `name` - title of the discussion
- `readers` - [wrap identifiers](#wrap-identifiers) for wraps to involve in this discussion
- `messages` - array of messages for this discussion
  - `wrap` - [wrap identifier](#wrap-identifiers) for the wrap this message was posted by
  - `message` - text content of this message


## File

The files specified by these objects will be uploaded to Filepicker.io and linked to file assets.

- `visibility` - see [Visibility](#visibility)
- `tags` - see [Tags](#tags)
- `name` - file name for the file asset
- `file` - path relative to the seed file where the file is located locally


## Gallery

- `visibility` - see [Visibility](#visibility)
- `tags` - see [Tags](#tags)
- `name` - title for the gallery
- `description` - short description about the gallery
- `slides` - array of slides in the order they should be presented
  - `name` - name of the slide
  - `description` - short description of the slide
  - `file` - image file for this slide
    - `name` - file name for the file asset
    - `file` - path relative to the seed file where the file is located locally
